<div id="DBPLUGIN_PARAMS_PgSQL">
	<p>PgSQL hostname and port:<br><input id="pgsql_host" type="text" value="localhost:5432" onkeypress="rebuild()" onkeyup="rebuild()">  <span id="pgsql_host_warn"></span></p>
	<p>PgSQL username:<br><input id="pgsql_username" type="text" onkeypress="rebuild()" onkeyup="rebuild()"> <span id="pgsql_username_warn"></span></p>
	<p>PgSQL password:<br><input id="pgsql_password" type="password" autocomplete="new-password" onkeypress="rebuild()" onkeyup="rebuild()"></p>
	<p>PgSQL database name:<br><input id="pgsql_database" type="text" onkeypress="rebuild()" onkeyup="rebuild()"> <span id="pgsql_database_warn"></span></p>
</div>
<script>
plugin_combobox_change_callbacks.push(function(strPlugin) {
	document.getElementById('DBPLUGIN_PARAMS_PgSQL').style.display = (strPlugin == 'PgSQL') ? "Block" : "None";
});
rebuild_callbacks.push(function() {
	var e = document.getElementById("db_plugin");
	var strPlugin = e.options[e.selectedIndex].value;
	if (strPlugin != 'PgSQL') return true;

	document.getElementById('struct_cli_1').innerHTML = '';
	document.getElementById('struct_cli_2').innerHTML = '';
	document.getElementById('struct_1').href = 'struct_empty.sql.php';
	document.getElementById('struct_2').href = 'struct_with_examples.sql.php';

	error = false;

	// Check 1: host must not be empty
	if (document.getElementById('pgsql_host').value.length == 0)
	{
		document.getElementById('pgsql_host_warn').innerHTML = '<font color="red">Please specify a host name!</font>';
		document.getElementById('config').innerHTML = '<b>&lt?php</b><br><br><i>// ERROR: Please specify a host name!</i>';
		error = true;
	} else {
		document.getElementById('pgsql_host_warn').innerHTML = '';
	}

	// Check 2: Username must not be empty
	if (document.getElementById('pgsql_username').value.length == 0)
	{
		document.getElementById('pgsql_username_warn').innerHTML = '<font color="red">Please specify a username!</font>';
		document.getElementById('config').innerHTML = '<b>&lt?php</b><br><br><i>// ERROR: Please specify a username!</i>';
		error = true;
	} else {
		document.getElementById('pgsql_username_warn').innerHTML = '';
	}

	// Check 3: Database name must not be empty
	if (document.getElementById('pgsql_database').value.length == 0)
	{
		document.getElementById('pgsql_database_warn').innerHTML = '<font color="red">Please specify a database name!</font>';
		document.getElementById('config').innerHTML = '<b>&lt?php</b><br><br><i>// ERROR: Please specify a database name!</i>';
		error = true;
	} else {
		document.getElementById('pgsql_database_warn').innerHTML = '';
	}

	document.getElementById('struct_1').href = setupdir+'struct_empty.sql.php?plugin=pgsql&prefix='+encodeURI(document.getElementById('tablename_prefix').value)+'&database='+encodeURI(document.getElementById('pgsql_database').value)+'&slang=pgsql';
	document.getElementById('struct_2').href = setupdir+'struct_with_examples.sql.php?plugin=pgsql&prefix='+encodeURI(document.getElementById('tablename_prefix').value)+'&database='+encodeURI(document.getElementById('pgsql_database').value)+'&slang=pgsql';
	document.getElementById('struct_cli_1').innerHTML = '<br>or via command line:<br><code>curl -s "'+document.getElementById('struct_1').href+'" | psql <!-- TODO: split host/port  -h '+document.getElementById('pgsql_host').value+' --> -U '+document.getElementById('pgsql_username').value+' -d '+document.getElementById('pgsql_database').value+' -a</code>';
	document.getElementById('struct_cli_2').innerHTML = '<br>or via command line:<br><code>curl -s "'+document.getElementById('struct_2').href+'" | psql <!-- TODO: split host/port  -h '+document.getElementById('pgsql_host').value+' --> -U '+document.getElementById('pgsql_username').value+' -d '+document.getElementById('pgsql_database').value+' -a</code>';

	return !error;
});
rebuild_config_callbacks.push(function() {
	var e = document.getElementById("db_plugin");
	var strPlugin = e.options[e.selectedIndex].value;
	if (strPlugin != 'PgSQL') return '';

	return '<b>define</b>(\'OIDPLUS_PGSQL_HOST\',       \''+document.getElementById('pgsql_host').value+'\');<br>' +
	       '<b>define</b>(\'OIDPLUS_PGSQL_USERNAME\',   \''+document.getElementById('pgsql_username').value+'\');<br>' +
	       '<b>define</b>(\'OIDPLUS_PGSQL_PASSWORD\',   \''+b64EncodeUnicode(document.getElementById('pgsql_password').value)+'\'); // base64 encoded<br>' +
	       '<b>define</b>(\'OIDPLUS_PGSQL_DATABASE\',   \''+document.getElementById('pgsql_database').value+'\');<br>';
});
</script>
